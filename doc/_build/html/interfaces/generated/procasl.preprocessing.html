

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>preprocessing &mdash; Arterial Spin Labeing Data Processing</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  

  
    <link rel="top" title="Arterial Spin Labeing Data Processing" href="../../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> procasl
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction: procasl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">Gallery of Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Secondary gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">Procasl API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">procasl</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
    <li>preprocessing</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="preprocessing">
<h1>preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">¶</a></h1>
<span class="target" id="procasl-preprocessing-average"></span><div class="section" id="average">
<span id="index-0"></span><h2>Average<a class="headerlink" href="#average" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="None">Link to code</a></p>
<p>Compute average functional across time, keeping the affine of
first scan.</p>
<div class="section" id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h3>
<p>This is a reimplementation of the averaging method of
average_2010.m from the GIN toolbox.</p>
<p>Inputs:</p>
<div class="highlight-python"><div class="highlight"><pre>[Mandatory]
in_file: (an existing file name)
        list of images filenames to average

[Optional]
ignore_exception: (a boolean, nipype default value: False)
        Print an error message instead of throwing an exception in case the
        interface fails to run
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-python"><div class="highlight"><pre>mean_file: (a list of items which are a list of items which are an
         existing file name or an existing file name)
        The average image file
</pre></div>
</div>
<span class="target" id="procasl-preprocessing-getm0"></span></div>
</div>
<div class="section" id="getm0">
<span id="index-1"></span><h2>GetM0<a class="headerlink" href="#getm0" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="None">Link to code</a></p>
<p>Save the M0 scan from ASL 4D image (first scan).</p>
<p>Inputs:</p>
<div class="highlight-python"><div class="highlight"><pre>[Mandatory]
in_file: (an existing file name)
        The input 4D ASL image filename

[Optional]
ignore_exception: (a boolean, nipype default value: False)
        Print an error message instead of throwing an exception in case the
        interface fails to run
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-python"><div class="highlight"><pre>m0_file: (an existing file name)
        The first scan image filename
</pre></div>
</div>
<span class="target" id="procasl-preprocessing-gettagcontrol"></span></div>
<div class="section" id="gettagcontrol">
<span id="index-2"></span><h2>GetTagControl<a class="headerlink" href="#gettagcontrol" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="None">Link to code</a></p>
<p>Save the tag/control sequence of a 4D ASL image (removes first scan).</p>
<p>Inputs:</p>
<div class="highlight-python"><div class="highlight"><pre>[Mandatory]
in_file: (an existing file name)
        The input 4D ASL image filename

[Optional]
ignore_exception: (a boolean, nipype default value: False)
        Print an error message instead of throwing an exception in case the
        interface fails to run
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-python"><div class="highlight"><pre>tag_ctl_file: (an existing file name)
        The tag/control sequence image filename
</pre></div>
</div>
<span class="target" id="procasl-preprocessing-realign"></span></div>
<div class="section" id="realign">
<span id="index-3"></span><h2>Realign<a class="headerlink" href="#realign" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="None">Link to code</a></p>
<p>Realign functional scans. Default parameters are those of the GIN
pipeline.</p>
<div class="section" id="id1">
<h3>Notes<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>This is a reimplementation of the realignement method from
myrealign_pasl_2010.m of GIN toolbox.</p>
</div>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>import procasl.preprocessing as asl
realign = asl.Realign
realign.inputs.in_file = &#8216;functional.nii&#8217;
realign.inputs.register_to_mean = False
realign.inputs.correct_tagging = True
out_realign = realign.run()
print(out_realign.realigned files, out_realign.realignement_parameters)</p>
<p>Inputs:</p>
<div class="highlight-python"><div class="highlight"><pre>[Mandatory]
in_file: (an existing file name)
        The filename of the input functional ASL 4D image.
register_to_mean: (a boolean, nipype default value: True)
        Indicate whether realignment is done to the mean image

[Optional]
control_scans: (a list of items which are an integer)
        control frames numbers
correct_tagging: (a boolean, nipype default value: False)
        True/False correct for tagging artifact by zeroing the mean
        difference between control and tag.
ignore_exception: (a boolean, nipype default value: False)
        Print an error message instead of throwing an exception in case the
        interface fails to run
paths: (a list of items which are an existing directory name)
        Paths to add to matlabpath
tag_scans: (a list of items which are an integer)
        tag frames numbers
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-python"><div class="highlight"><pre>realigned_files: (a list of items which are a list of items which are
         an existing file name or an existing file name)
        The resliced files
realignment_parameters: (a list of items which are an existing file
         name)
        Estimated translation and rotation parameters
</pre></div>
</div>
<span class="target" id="procasl-preprocessing-rescale"></span></div>
</div>
<div class="section" id="rescale">
<span id="index-4"></span><h2>Rescale<a class="headerlink" href="#rescale" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="None">Link to code</a></p>
<p>Correct for T1 relaxation between different slices. This is a
reimplementation of the rescaling method of
correction_scalefactors_philips_2010.m from the GIN toolbox,
courtesy of...
PASL images are acquired in EPI single shot with slices from
bottom to up of the brain.
For PASL,
CBF (ml/100g/min) = deltaM / (2 * M0b * tao * exp(-TI / T1b) * qTI)
and
M0b = Rwm * M0WM * exp((1/T2wm-1/T2b)*TE)
or M0b=Rcsf*M0csf*exp((1/T2csf-1/T2b)*TE)
or M0b = MPD / (1 - exp(-TR / T1_tissue)),
TI is the inversion time for different slice;
T1b is the constant relaxation time of arterial blood.
tao is actually TI1 in QUIPPS II
qTI is close to unit, and is set to 0.85 in Warmuth 05. In addition, we
introduce the label efficiency in the calculation.
Rwm  - proton density ratio between blood and WM1.06 in Wong 97. 1.19 in
Cavosuglu 09; T2wm and T2b are 55 msec and 100 for 1.5T, 40 and 80 for 3T,
30 and 60 for 4T;
Rcsf - proton density ratio between blood and csf, 0.87 in Cavosuglu,
T2csf is 74.9 ms for 3T.
M0WM means the mean value in an homogenous white matter region, and it
could be selected by drawing an ROI in the M0 image.
Please refer to: 1) Buxton et al, 1998 MRM 40:383-96, 2) Warmuth C.,
Gunther M. and Zimmer G. Radiology, 2003; 228:523-532.
Note (Nov 19 2010): T2wm and T2b at 3T were changed to 44.7 and 43.6,
T2csf if used was set to 74.9 according to Cavusoglu 09 MRI</p>
<div class="section" id="id2">
<h3>Examples<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>from procasl.preprocessing as asl
rescale = asl.Rescale
rescale.inputs.in_file = &#8216;raw_asl.nii&#8217;
rescale.inputs.ss_tr = 35.
rescale.inputs.t_i_1 = 800.
rescale.inputs.t_i_2 = 1800.
out_rescale = rescale.run()
print(out_rescale.rescaleed files)</p>
<p>Inputs:</p>
<div class="highlight-python"><div class="highlight"><pre>[Mandatory]
in_file: (an existing file name)
        list of images filenames to rescale
ss_tr: (a float)
        Single slice repetition time, in ms
t_i_1: (a float)
        Bolus length, in ms
t_i_2: (a float)
        Inversion time (time from the application of the labelingpulse to
        image acquisition, Aslop 2014), in ms

[Optional]
ignore_exception: (a boolean, nipype default value: False)
        Print an error message instead of throwing an exception in case the
        interface fails to run
label_efficiency: (a float, nipype default value: 0.98)
        labeling efficiency
t1_blood: (a float, nipype default value: 1650.0)
        T1 of the blood in ms
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-python"><div class="highlight"><pre>rescaled_file: (a list of items which are a list of items which are
         an existing file name or an existing file name)
        The rescaled image file
</pre></div>
</div>
<span class="target" id="module-procasl.preprocessing"></span></div>
</div>
<div class="section" id="add-prefix">
<span id="procasl-preprocessing-add-prefix"></span><h2><a class="reference internal" href="../../modules/generated/procasl.preprocessing.html#procasl.preprocessing.add_prefix" title="procasl.preprocessing.add_prefix"><code class="xref py py-func docutils literal"><span class="pre">add_prefix</span></code></a><a class="headerlink" href="#add-prefix" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="None">Link to code</a></p>
<p>Adds a prefix to a filename</p>
<div class="section" id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>prefix <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>Prefix to append to the filename</dd>
<dt>in_file <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>Input file name.</dd>
</dl>
</div>
<div class="section" id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>out_file <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>Output file name</dd>
</dl>
</div>
</div>
<div class="section" id="apply-mask">
<span id="procasl-preprocessing-apply-mask"></span><h2><a class="reference internal" href="../../modules/generated/procasl.preprocessing.html#procasl.preprocessing.apply_mask" title="procasl.preprocessing.apply_mask"><code class="xref py py-func docutils literal"><span class="pre">apply_mask</span></code></a><a class="headerlink" href="#apply-mask" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="None">Link to code</a></p>
<p>Masks input with a binary mask_file.</p>
</div>
<div class="section" id="binarize-mask">
<span id="procasl-preprocessing-binarize-mask"></span><h2><a class="reference internal" href="../../modules/generated/procasl.preprocessing.html#procasl.preprocessing.binarize_mask" title="procasl.preprocessing.binarize_mask"><code class="xref py py-func docutils literal"><span class="pre">binarize_mask</span></code></a><a class="headerlink" href="#binarize-mask" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="None">Link to code</a></p>
</div>
<div class="section" id="compute-brain-mask">
<span id="procasl-preprocessing-compute-brain-mask"></span><h2><a class="reference internal" href="../../modules/generated/procasl.preprocessing.html#procasl.preprocessing.compute_brain_mask" title="procasl.preprocessing.compute_brain_mask"><code class="xref py py-func docutils literal"><span class="pre">compute_brain_mask</span></code></a><a class="headerlink" href="#compute-brain-mask" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="None">Link to code</a></p>
<p>Computes binary brain mask using FSL BET.</p>
</div>
<div class="section" id="compute-mask">
<span id="procasl-preprocessing-compute-mask"></span><h2><a class="reference internal" href="../../modules/generated/procasl.preprocessing.html#procasl.preprocessing.compute_mask" title="procasl.preprocessing.compute_mask"><code class="xref py py-func docutils literal"><span class="pre">compute_mask</span></code></a><a class="headerlink" href="#compute-mask" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="None">Link to code</a></p>
<p>Compute a brain mask from a 4D or a3D image.</p>
</div>
<div class="section" id="get-scans-number">
<span id="procasl-preprocessing-get-scans-number"></span><h2><a class="reference internal" href="../../modules/generated/procasl.preprocessing.html#procasl.preprocessing.get_scans_number" title="procasl.preprocessing.get_scans_number"><code class="xref py py-func docutils literal"><span class="pre">get_scans_number</span></code></a><a class="headerlink" href="#get-scans-number" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="None">Link to code</a></p>
<p>Return the number of scans for a 4D image.</p>
</div>
<div class="section" id="save-first-scan">
<span id="procasl-preprocessing-save-first-scan"></span><h2><a class="reference internal" href="../../modules/generated/procasl.preprocessing.html#procasl.preprocessing.save_first_scan" title="procasl.preprocessing.save_first_scan"><code class="xref py py-func docutils literal"><span class="pre">save_first_scan</span></code></a><a class="headerlink" href="#save-first-scan" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="None">Link to code</a></p>
</div>
<div class="section" id="select-scans">
<span id="procasl-preprocessing-select-scans"></span><h2><a class="reference internal" href="../../modules/generated/procasl.preprocessing.html#procasl.preprocessing.select_scans" title="procasl.preprocessing.select_scans"><code class="xref py py-func docutils literal"><span class="pre">select_scans</span></code></a><a class="headerlink" href="#select-scans" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="None">Link to code</a></p>
<p>Save a selected scan volumes from a 4D image.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, The procasl developers.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>