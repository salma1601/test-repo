

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>procasl.preprocessing &mdash; Arterial Spin Labeing Data Processing</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  

  
    <link rel="top" title="Arterial Spin Labeing Data Processing" href="../../index.html"/>
        <link rel="up" title="Procasl API Reference" href="../../reference.html"/>
        <link rel="next" title="procasl.quantification" href="procasl.quantification.html"/>
        <link rel="prev" title="procasl.datasets" href="procasl.datasets.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> procasl
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction: procasl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">Gallery of Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Secondary gallery</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../reference.html">Procasl API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="procasl.datasets.html">procasl.datasets</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">procasl.preprocessing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="procasl.quantification.html">procasl.quantification</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">procasl</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../reference.html">Procasl API Reference</a> &raquo;</li>
      
    <li>procasl.preprocessing</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-procasl.preprocessing">
<span id="procasl-preprocessing"></span><h1>procasl.preprocessing<a class="headerlink" href="#module-procasl.preprocessing" title="Permalink to this headline">¶</a></h1>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="procasl.preprocessing.add_prefix">
<code class="descclassname">procasl.preprocessing.</code><code class="descname">add_prefix</code><span class="sig-paren">(</span><em>prefix</em>, <em>in_file</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.add_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a prefix to a filename</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>prefix</strong> : str</p>
<blockquote>
<div><p>Prefix to append to the filename</p>
</div></blockquote>
<p><strong>in_file</strong> : str</p>
<blockquote>
<div><p>Input file name.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out_file</strong> : str</p>
<blockquote class="last">
<div><p>Output file name</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div style='clear:both'></div><dl class="function">
<dt id="procasl.preprocessing.apply_mask">
<code class="descclassname">procasl.preprocessing.</code><code class="descname">apply_mask</code><span class="sig-paren">(</span><em>in_file</em>, <em>mask_file</em>, <em>mask_value=nan</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.apply_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks input with a binary mask_file.</p>
</dd></dl>

<div style='clear:both'></div><dl class="function">
<dt id="procasl.preprocessing.binarize_mask">
<code class="descclassname">procasl.preprocessing.</code><code class="descname">binarize_mask</code><span class="sig-paren">(</span><em>in_file</em>, <em>threshold=0.5</em>, <em>out_file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.binarize_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<div style='clear:both'></div><dl class="function">
<dt id="procasl.preprocessing.check_images">
<code class="descclassname">procasl.preprocessing.</code><code class="descname">check_images</code><span class="sig-paren">(</span><em>file1</em>, <em>file2</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.check_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that 2 images have the same affines and data shapes.</p>
</dd></dl>

<div style='clear:both'></div><dl class="function">
<dt id="procasl.preprocessing.compute_brain_mask">
<code class="descclassname">procasl.preprocessing.</code><code class="descname">compute_brain_mask</code><span class="sig-paren">(</span><em>in_file</em>, <em>frac=0.5</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.compute_brain_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes binary brain mask using FSL BET.</p>
</dd></dl>

<div style='clear:both'></div><dl class="function">
<dt id="procasl.preprocessing.compute_mask">
<code class="descclassname">procasl.preprocessing.</code><code class="descname">compute_mask</code><span class="sig-paren">(</span><em>in_file</em>, <em>out_file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.compute_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a brain mask from a 4D or a3D image.</p>
</dd></dl>

<div style='clear:both'></div><dl class="function">
<dt id="procasl.preprocessing.get_scans_number">
<code class="descclassname">procasl.preprocessing.</code><code class="descname">get_scans_number</code><span class="sig-paren">(</span><em>in_file</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.get_scans_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of scans for a 4D image.</p>
</dd></dl>

<div style='clear:both'></div><dl class="function">
<dt id="procasl.preprocessing.params_to_affine">
<code class="descclassname">procasl.preprocessing.</code><code class="descname">params_to_affine</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.params_to_affine" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms parameters to an affine matrix transform.
Mimics the spm function spm_matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>params</strong> : 1D numpy.ndarray of size 6 or 12</p>
<blockquote>
<div><p>Parameters of the transform, in the following order:
Tx, Ty, Tz, pitch, roll, yaw
and possibly 3 zooms and 3 shears</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>affine</strong> : numpy.ndarray of shape (4, 4)</p>
<blockquote class="last">
<div><p>The affine transformation matrix.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div style='clear:both'></div><dl class="function">
<dt id="procasl.preprocessing.save_first_scan">
<code class="descclassname">procasl.preprocessing.</code><code class="descname">save_first_scan</code><span class="sig-paren">(</span><em>asl_file</em>, <em>out_file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.save_first_scan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<div style='clear:both'></div><dl class="function">
<dt id="procasl.preprocessing.savemat">
<code class="descclassname">procasl.preprocessing.</code><code class="descname">savemat</code><span class="sig-paren">(</span><em>file_name</em>, <em>mdict</em>, <em>appendmat=True</em>, <em>format='5'</em>, <em>long_field_names=False</em>, <em>do_compression=False</em>, <em>oned_as='row'</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.savemat" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a dictionary of names and arrays into a MATLAB-style .mat file.</p>
<p>This saves the array objects in the given dictionary to a MATLAB-
style .mat file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>file_name</strong> : str or file-like object</p>
<blockquote>
<div><p>Name of the .mat file (.mat extension not needed if <code class="docutils literal"><span class="pre">appendmat</span> <span class="pre">==</span>
<span class="pre">True</span></code>).
Can also pass open file_like object.</p>
</div></blockquote>
<p><strong>mdict</strong> : dict</p>
<blockquote>
<div><p>Dictionary from which to save matfile variables.</p>
</div></blockquote>
<p><strong>appendmat</strong> : bool, optional</p>
<blockquote>
<div><p>True (the default) to append the .mat extension to the end of the
given filename, if not already present.</p>
</div></blockquote>
<p><strong>format</strong> : {&#8216;5&#8217;, &#8216;4&#8217;}, string, optional</p>
<blockquote>
<div><p>&#8216;5&#8217; (the default) for MATLAB 5 and up (to 7.2),
&#8216;4&#8217; for MATLAB 4 .mat files</p>
</div></blockquote>
<p><strong>long_field_names</strong> : bool, optional</p>
<blockquote>
<div><p>False (the default) - maximum field name length in a structure is
31 characters which is the documented maximum length.
True - maximum field name length in a structure is 63 characters
which works for MATLAB 7.6+</p>
</div></blockquote>
<p><strong>do_compression</strong> : bool, optional</p>
<blockquote>
<div><p>Whether or not to compress matrices on write.  Default is False.</p>
</div></blockquote>
<p><strong>oned_as</strong> : {&#8216;row&#8217;, &#8216;column&#8217;}, optional</p>
<blockquote class="last">
<div><p>If &#8216;column&#8217;, write 1-D numpy arrays as column vectors.
If &#8216;row&#8217;, write 1-D numpy arrays as row vectors.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-obj docutils literal"><span class="pre">mio4.MatFile4Writer</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">mio5.MatFile5Writer</span></code></p>
</div>
</dd></dl>

<div style='clear:both'></div><dl class="function">
<dt id="procasl.preprocessing.select_scans">
<code class="descclassname">procasl.preprocessing.</code><code class="descname">select_scans</code><span class="sig-paren">(</span><em>in_file</em>, <em>selected_scans</em>, <em>convert_3d=True</em>, <em>out_file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.select_scans" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a selected scan volumes from a 4D image.</p>
</dd></dl>

<div style='clear:both'></div><dl class="function">
<dt id="procasl.preprocessing.split_filename">
<code class="descclassname">procasl.preprocessing.</code><code class="descname">split_filename</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.split_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a filename into parts: path, base filename and extension.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str</p>
<blockquote>
<div><p>file or path name</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pth</strong> : str</p>
<blockquote>
<div><p>base path from fname</p>
</div></blockquote>
<p><strong>fname</strong> : str</p>
<blockquote>
<div><p>filename from fname, without extension</p>
</div></blockquote>
<p><strong>ext</strong> : str</p>
<blockquote class="last">
<div><p>file extension from fname</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nipype.utils.filemanip</span> <span class="kn">import</span> <span class="n">split_filename</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pth</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">split_filename</span><span class="p">(</span><span class="s">&#39;/home/data/subject.nii.gz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pth</span>
<span class="go">&#39;/home/data&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span>
<span class="go">&#39;subject&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ext</span>
<span class="go">&#39;.nii.gz&#39;</span>
</pre></div>
</div>
</dd></dl>

<div style='clear:both'></div><dl class="function">
<dt id="procasl.preprocessing.spm_affine">
<code class="descclassname">procasl.preprocessing.</code><code class="descname">spm_affine</code><span class="sig-paren">(</span><em>in_file</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.spm_affine" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the affine transform of a nifti image.
Mimics the spm function spm_get_space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>in_file</strong> : str</p>
<blockquote>
<div><p>Path to an existant nifti image.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>affine</strong> : numpy.ndarray of shape (4, 4)</p>
<blockquote class="last">
<div><p>The affine transformation matrix.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function uses nibabel to read the affine transform and corrects the
translation part to match the affine output of spm.</p>
</dd></dl>

<div style='clear:both'></div></div>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#procasl.preprocessing.Average" title="procasl.preprocessing.Average"><code class="xref py py-obj docutils literal"><span class="pre">Average</span></code></a>(**inputs)</td>
<td>Compute average functional across time, keeping the affine of first scan.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">AverageInputSpec</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">AverageOutputSpec</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">BaseInterface</span></code>(**inputs)</td>
<td>Implements common interface functionality.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">BaseInterfaceInputSpec</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">Directory</span></code>([value,&nbsp;auto_set,&nbsp;entries,&nbsp;exists])</td>
<td>Defines a trait whose value must be the name of a directory using a C-level fast validator.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">File</span></code>([value,&nbsp;filter,&nbsp;auto_set,&nbsp;entries,&nbsp;exists])</td>
<td>Defines a trait whose value must be the name of a file using a C-level fast validator.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#procasl.preprocessing.GetM0" title="procasl.preprocessing.GetM0"><code class="xref py py-obj docutils literal"><span class="pre">GetM0</span></code></a>(**inputs)</td>
<td>Save the M0 scan from ASL 4D image (first scan).</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">GetM0InputSpec</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">GetM0OutputSpec</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#procasl.preprocessing.GetTagControl" title="procasl.preprocessing.GetTagControl"><code class="xref py py-obj docutils literal"><span class="pre">GetTagControl</span></code></a>(**inputs)</td>
<td>Save the tag/control sequence of a 4D ASL image (removes first scan).</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">GetTagControlInputSpec</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">GetTagControlOutputSpec</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">InputMultiPath</span></code>([trait,&nbsp;value,&nbsp;minlen,&nbsp;...])</td>
<td>Implements a user friendly traits that accepts one or more paths to files or directories.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">OutputMultiPath</span></code>([trait,&nbsp;value,&nbsp;minlen,&nbsp;...])</td>
<td>Implements a user friendly traits that accepts one or more paths to files or directories.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#procasl.preprocessing.Realign" title="procasl.preprocessing.Realign"><code class="xref py py-obj docutils literal"><span class="pre">Realign</span></code></a>(**inputs)</td>
<td>Realign functional scans.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">RealignInputSpec</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">RealignOutputSpec</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#procasl.preprocessing.Rescale" title="procasl.preprocessing.Rescale"><code class="xref py py-obj docutils literal"><span class="pre">Rescale</span></code></a>(**inputs)</td>
<td>Correct for T1 relaxation between different slices.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">RescaleInputSpec</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">RescaleOutputSpec</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">TraitedSpec</span></code>(**kwargs)</td>
<td>Create a subclass with strict traits.</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="procasl.preprocessing.Average">
<em class="property">class </em><code class="descclassname">procasl.preprocessing.</code><code class="descname">Average</code><span class="sig-paren">(</span><em>**inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.Average" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute average functional across time, keeping the affine of
first scan.</p>
<p class="rubric">Notes</p>
<p>This is a reimplementation of the averaging method of
average_2010.m from the GIN toolbox.</p>
<dl class="method">
<dt id="procasl.preprocessing.Average.aggregate_outputs">
<code class="descname">aggregate_outputs</code><span class="sig-paren">(</span><em>runtime=None</em>, <em>needed_outputs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.Average.aggregate_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Collate expected outputs and check for existence</p>
</dd></dl>

<dl class="method">
<dt id="procasl.preprocessing.Average.help">
<code class="descname">help</code><span class="sig-paren">(</span><em>returnhelp=False</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.Average.help" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints class help</p>
</dd></dl>

<dl class="method">
<dt id="procasl.preprocessing.Average.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>**inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.Average.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute this interface.</p>
<p>This interface will not raise an exception if runtime.returncode is
non-zero.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>inputs</strong> : allows the interface settings to be updated</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>results</strong> :  an InterfaceResult object containing a copy of the instance</p>
<p class="last">that was executed, provenance information and, if successful, results</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="procasl.preprocessing.GetM0">
<em class="property">class </em><code class="descclassname">procasl.preprocessing.</code><code class="descname">GetM0</code><span class="sig-paren">(</span><em>**inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.GetM0" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the M0 scan from ASL 4D image (first scan).</p>
<dl class="method">
<dt id="procasl.preprocessing.GetM0.aggregate_outputs">
<code class="descname">aggregate_outputs</code><span class="sig-paren">(</span><em>runtime=None</em>, <em>needed_outputs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.GetM0.aggregate_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Collate expected outputs and check for existence</p>
</dd></dl>

<dl class="method">
<dt id="procasl.preprocessing.GetM0.help">
<code class="descname">help</code><span class="sig-paren">(</span><em>returnhelp=False</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.GetM0.help" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints class help</p>
</dd></dl>

<dl class="method">
<dt id="procasl.preprocessing.GetM0.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>**inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.GetM0.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute this interface.</p>
<p>This interface will not raise an exception if runtime.returncode is
non-zero.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>inputs</strong> : allows the interface settings to be updated</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>results</strong> :  an InterfaceResult object containing a copy of the instance</p>
<p class="last">that was executed, provenance information and, if successful, results</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="procasl.preprocessing.GetTagControl">
<em class="property">class </em><code class="descclassname">procasl.preprocessing.</code><code class="descname">GetTagControl</code><span class="sig-paren">(</span><em>**inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.GetTagControl" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the tag/control sequence of a 4D ASL image (removes first scan).</p>
<dl class="method">
<dt id="procasl.preprocessing.GetTagControl.aggregate_outputs">
<code class="descname">aggregate_outputs</code><span class="sig-paren">(</span><em>runtime=None</em>, <em>needed_outputs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.GetTagControl.aggregate_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Collate expected outputs and check for existence</p>
</dd></dl>

<dl class="method">
<dt id="procasl.preprocessing.GetTagControl.help">
<code class="descname">help</code><span class="sig-paren">(</span><em>returnhelp=False</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.GetTagControl.help" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints class help</p>
</dd></dl>

<dl class="method">
<dt id="procasl.preprocessing.GetTagControl.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>**inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.GetTagControl.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute this interface.</p>
<p>This interface will not raise an exception if runtime.returncode is
non-zero.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>inputs</strong> : allows the interface settings to be updated</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>results</strong> :  an InterfaceResult object containing a copy of the instance</p>
<p class="last">that was executed, provenance information and, if successful, results</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="procasl.preprocessing.Realign">
<em class="property">class </em><code class="descclassname">procasl.preprocessing.</code><code class="descname">Realign</code><span class="sig-paren">(</span><em>**inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.Realign" title="Permalink to this definition">¶</a></dt>
<dd><p>Realign functional scans. Default parameters are those of the GIN
pipeline.</p>
<p class="rubric">Notes</p>
<p>This is a reimplementation of the realignement method from
myrealign_pasl_2010.m of GIN toolbox.</p>
<p class="rubric">Examples</p>
<p>import procasl.preprocessing as asl
realign = asl.Realign
realign.inputs.in_file = &#8216;functional.nii&#8217;
realign.inputs.register_to_mean = False
realign.inputs.correct_tagging = True
out_realign = realign.run()
print(out_realign.realigned files, out_realign.realignement_parameters)</p>
<dl class="method">
<dt id="procasl.preprocessing.Realign.aggregate_outputs">
<code class="descname">aggregate_outputs</code><span class="sig-paren">(</span><em>runtime=None</em>, <em>needed_outputs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.Realign.aggregate_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Collate expected outputs and check for existence</p>
</dd></dl>

<dl class="method">
<dt id="procasl.preprocessing.Realign.help">
<code class="descname">help</code><span class="sig-paren">(</span><em>returnhelp=False</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.Realign.help" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints class help</p>
</dd></dl>

<dl class="method">
<dt id="procasl.preprocessing.Realign.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>**inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.Realign.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute this interface.</p>
<p>This interface will not raise an exception if runtime.returncode is
non-zero.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>inputs</strong> : allows the interface settings to be updated</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>results</strong> :  an InterfaceResult object containing a copy of the instance</p>
<p class="last">that was executed, provenance information and, if successful, results</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="procasl.preprocessing.Rescale">
<em class="property">class </em><code class="descclassname">procasl.preprocessing.</code><code class="descname">Rescale</code><span class="sig-paren">(</span><em>**inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.Rescale" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct for T1 relaxation between different slices. This is a
reimplementation of the rescaling method of
correction_scalefactors_philips_2010.m from the GIN toolbox,
courtesy of...
PASL images are acquired in EPI single shot with slices from
bottom to up of the brain.
For PASL,
CBF (ml/100g/min) = deltaM / (2 * M0b * tao * exp(-TI / T1b) * qTI)
and
M0b = Rwm * M0WM * exp((1/T2wm-1/T2b)*TE)
or M0b=Rcsf*M0csf*exp((1/T2csf-1/T2b)*TE)
or M0b = MPD / (1 - exp(-TR / T1_tissue)),
TI is the inversion time for different slice;
T1b is the constant relaxation time of arterial blood.
tao is actually TI1 in QUIPPS II
qTI is close to unit, and is set to 0.85 in Warmuth 05. In addition, we
introduce the label efficiency in the calculation.
Rwm  - proton density ratio between blood and WM1.06 in Wong 97. 1.19 in
Cavosuglu 09; T2wm and T2b are 55 msec and 100 for 1.5T, 40 and 80 for 3T,
30 and 60 for 4T;
Rcsf - proton density ratio between blood and csf, 0.87 in Cavosuglu,
T2csf is 74.9 ms for 3T.
M0WM means the mean value in an homogenous white matter region, and it
could be selected by drawing an ROI in the M0 image.
Please refer to: 1) Buxton et al, 1998 MRM 40:383-96, 2) Warmuth C.,
Gunther M. and Zimmer G. Radiology, 2003; 228:523-532.
Note (Nov 19 2010): T2wm and T2b at 3T were changed to 44.7 and 43.6,
T2csf if used was set to 74.9 according to Cavusoglu 09 MRI</p>
<p class="rubric">Examples</p>
<p>from procasl.preprocessing as asl
rescale = asl.Rescale
rescale.inputs.in_file = &#8216;raw_asl.nii&#8217;
rescale.inputs.ss_tr = 35.
rescale.inputs.t_i_1 = 800.
rescale.inputs.t_i_2 = 1800.
out_rescale = rescale.run()
print(out_rescale.rescaleed files)</p>
<dl class="method">
<dt id="procasl.preprocessing.Rescale.aggregate_outputs">
<code class="descname">aggregate_outputs</code><span class="sig-paren">(</span><em>runtime=None</em>, <em>needed_outputs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.Rescale.aggregate_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Collate expected outputs and check for existence</p>
</dd></dl>

<dl class="method">
<dt id="procasl.preprocessing.Rescale.help">
<code class="descname">help</code><span class="sig-paren">(</span><em>returnhelp=False</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.Rescale.help" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints class help</p>
</dd></dl>

<dl class="method">
<dt id="procasl.preprocessing.Rescale.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>**inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#procasl.preprocessing.Rescale.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute this interface.</p>
<p>This interface will not raise an exception if runtime.returncode is
non-zero.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>inputs</strong> : allows the interface settings to be updated</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>results</strong> :  an InterfaceResult object containing a copy of the instance</p>
<p class="last">that was executed, provenance information and, if successful, results</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">procasl.preprocessing.</code><code class="descname">add_prefix</code><span class="sig-paren">(</span><em>prefix</em>, <em>in_file</em><span class="sig-paren">)</span></dt>
<dd><p>Adds a prefix to a filename</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>prefix</strong> : str</p>
<blockquote>
<div><p>Prefix to append to the filename</p>
</div></blockquote>
<p><strong>in_file</strong> : str</p>
<blockquote>
<div><p>Input file name.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out_file</strong> : str</p>
<blockquote class="last">
<div><p>Output file name</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">procasl.preprocessing.</code><code class="descname">apply_mask</code><span class="sig-paren">(</span><em>in_file</em>, <em>mask_file</em>, <em>mask_value=nan</em><span class="sig-paren">)</span></dt>
<dd><p>Masks input with a binary mask_file.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">procasl.preprocessing.</code><code class="descname">compute_brain_mask</code><span class="sig-paren">(</span><em>in_file</em>, <em>frac=0.5</em><span class="sig-paren">)</span></dt>
<dd><p>Computes binary brain mask using FSL BET.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">procasl.preprocessing.</code><code class="descname">compute_mask</code><span class="sig-paren">(</span><em>in_file</em>, <em>out_file=None</em><span class="sig-paren">)</span></dt>
<dd><p>Compute a brain mask from a 4D or a3D image.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">procasl.preprocessing.</code><code class="descname">get_scans_number</code><span class="sig-paren">(</span><em>in_file</em><span class="sig-paren">)</span></dt>
<dd><p>Return the number of scans for a 4D image.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">procasl.preprocessing.</code><code class="descname">select_scans</code><span class="sig-paren">(</span><em>in_file</em>, <em>selected_scans</em>, <em>convert_3d=True</em>, <em>out_file=None</em><span class="sig-paren">)</span></dt>
<dd><p>Save a selected scan volumes from a 4D image.</p>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="procasl.quantification.html" class="btn btn-neutral float-right" title="procasl.quantification" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="procasl.datasets.html" class="btn btn-neutral" title="procasl.datasets" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, The procasl developers.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>